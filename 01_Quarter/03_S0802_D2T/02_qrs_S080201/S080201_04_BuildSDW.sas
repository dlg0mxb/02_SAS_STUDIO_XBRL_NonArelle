PROC SQL ;

OPTIONS MISSING='';

CREATE TABLE SDW_S080201_PARTA_VW AS 

SELECT 

	 C0040 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0070 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0090 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, PORT.XBRL_CD AS C0060_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0060 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, LINK.XBRL_CD AS C0080_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0080 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, DVTS.XBRL_CD AS C0110_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0110 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0120 FORMAT = 12.2 INFORMAT=COMMA12. LABEL = ''

	, '' AS C0130_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0130 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0140 FORMAT = 12.2 LABEL = ''
	, C0150 FORMAT = 12.2 LABEL = ''
	, C0160 FORMAT = 12.2 LABEL = ''
	, C0170 FORMAT 12. LABEL = ''
	, C0180 LABEL = '' INFORMAT=$100. FORMAT=$100. LENGTH=100
	, C0190 LABEL = '' INFORMAT=$100. FORMAT=$100. LENGTH=100
	, C0200 FORMAT = 12.2 LABEL = ''
	, C0210 FORMAT = 12.2 LABEL = ''
	, PUT(C0220,YYMMDD10.) AS C0220  FORMAT=$CHAR10. LABEL = ''
	, C0230 FORMAT = 12.2 LABEL = ''
	

FROM 
	SDW_S080201_PART_A 

LEFT JOIN 
	X_EIOPA_CD PORT
		ON 
			C0060 = PORT.EIOPA_CD
			AND PORT.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND PORT.EIOPA_CATEGORY = 'PORTFOLIO_CLASSIFICATION'


LEFT JOIN 
	X_EIOPA_CD LINK
		ON 
			TRIM(C0080) = TRIM(LINK.EIOPA_CD)
			AND LINK.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(LINK.EIOPA_CATEGORY) = 'UNIT_INDEX_LINKED'

LEFT JOIN 
	X_EIOPA_CD DVTS
		ON 
			C0110 = DVTS.EIOPA_CD
			AND DVTS.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(DVTS.EIOPA_CATEGORY) = 'USE_OF_DRVTS'
;

QUIT;


/*********************************************************************************/

PROC SQL ;

OPTIONS MISSING='';

CREATE TABLE SDW_S080201_PARTB_VW AS 

SELECT 

	C0040 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0240 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0250 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0270 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0280 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0300 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, CASE 
		WHEN C0310 = '' THEN ''
		ELSE 's2c_CU:'||C0310
	  END AS C0310_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0310 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, C0320 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0330 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, UNWI.XBRL_CD AS C0340_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0340 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, '' AS C0350_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 
	, C0350 AS C0350 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, '' AS C0360_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0360 AS C0360 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, PUT(C0370,YYMMDD10.) AS C0370  FORMAT=$10. 


FROM 
	SDW_S080201_PART_B 


LEFT JOIN 
	X_EIOPA_CD UNWI
		ON 
			TRIM(C0340) = TRIM(UNWI.EIOPA_CD)
			AND UNWI.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(UNWI.EIOPA_CATEGORY) = 'UNWIND_TRIGGER'
	;

QUIT;

