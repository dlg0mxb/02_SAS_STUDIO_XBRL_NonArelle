PROC SQL ;

OPTIONS MISSING='';

CREATE TABLE SDW_S060204_PARTA_VW AS 

SELECT 
	
	C0020 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0040 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0070 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0080 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0010 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0060 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, PORT.XBRL_CD AS C0060_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0090 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, LINK.XBRL_CD AS C0090_XBRL  INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0100 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, COLL.XBRL_CD AS C0100_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0110 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, CASE 
		WHEN C0110 = 'GBXT' THEN 's2c_GA:x115' 
		ELSE CASE 
				WHEN C0110 = '' THEN ''
				ELSE TRIM('s2c_GA:'||TRIM(C0110)) 
			 END 
	  END AS C0110_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0120 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 
	, C0130 FORMAT = 12.4  LABEL = '' 
	, C0140 FORMAT = 12.2  LABEL = '' 

	, C0150 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, SUBSTR(TRIM(VALU.XBRL_CD),1,INDEX(TRIM(VALU.XBRL_CD),'/')-1) AS C0150_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0160 FORMAT = 12.2 LABEL=''
	, C0170 FORMAT = 12.2 LABEL=''
	, C0180 FORMAT = 12.2 LABEL=''

FROM 
	SDW_S060204_PART_A 

LEFT JOIN 
	X_EIOPA_CD PORT
		ON 
			C0060 = PORT.EIOPA_CD
			AND PORT.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND PORT.EIOPA_CATEGORY = 'PORTFOLIO_CLASSIFICATION'

LEFT JOIN 
	X_EIOPA_CD LINK
		ON 
			TRIM(C0090) = TRIM(LINK.EIOPA_CD)
			AND LINK.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(LINK.EIOPA_CATEGORY) = 'UNIT_INDEX_LINKED'

LEFT JOIN 
	X_EIOPA_CD COLL
		ON 
			C0100 = COLL.EIOPA_CD
			AND COLL.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(COLL.EIOPA_CATEGORY) = 'COLLATERAL_STATUS'

LEFT JOIN 
	X_EIOPA_CD VALU
		ON 
			C0150 = VALU.EIOPA_CD 
			AND VALU.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(VALU.EIOPA_CATEGORY) = 'VALUATION_METHOD'

		;
QUIT;



PROC SQL ;

OPTIONS MISSING='';

CREATE TABLE SDW_S060204_PARTB_VW AS 

SELECT 
	
 	C0040 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0190 INFORMAT=$200. FORMAT=$200. LENGTH=200 LABEL = ''
	, C0200 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''  
	, C0210 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, CASE 
		WHEN C0230 = '' THEN '' 
		ELSE 's2c_NC:'||TRIM(C0230) 
	  END AS C0230_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 
	, C0230 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, COMPRESS(C0240) AS C0240 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 
	, C0250  INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, CASE 
		WHEN C0270 = '' THEN ''
		WHEN C0270 = 'GBXT' THEN 's2c_GA:x115'
		WHEN C0270 = 'GIXT' THEN 's2c_GA:x116'
		ELSE 's2c_GA:'||C0270
	  END AS C0270_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 
	, C0270 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, CASE 
		WHEN C0280 = '' THEN ''
		ELSE 's2c_CU:'||C0280
	  END AS C0280_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 
	, C0280  INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, C0290 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, INFRA.XBRL_CD AS C0300_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 
	, C0300 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, PART.XBRL_CD AS C0310_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 
	, C0310 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, C0320 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, CASE 
		WHEN C0330 = 'S&P Global Ratings Europe Limited (LEI code:5493008B2TU3S6QE1E12)'  THEN 's2c_SE:x179'
		WHEN C0330 = 'Fitch Ratings Limited (LEI code: 2138009F8YAHVC8W3Q52)' THEN 's2c_SE:x147'
		WHEN C0330 = 'Moody¡¦s Investors Service Ltd (LEI code: 549300SM89WABHDNJ349)'  THEN 's2c_SE:x154'
		ELSE ECAI.XBRL_CD 
	   END AS C0330_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 
	, C0330 INFORMAT=$200. FORMAT=$200. LENGTH=200 LABEL = '' 

	, QUAL.XBRL_CD AS C0340_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 
	, C0340 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, C0350 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = '' 

	, C0360 LABEL = '' FORMAT=COMMA15.4

	/*Invoke is accepting only two decimals for these variables */
	, ROUND(C0370,0.01) AS C0370 FORMAT=12.2 INFORMAT=COMMA12. LABEL=''
	, ROUND(C0380,0.0001) AS C0380 FORMAT = 12.4 INFORMAT=COMMA12. LABEL=''

	, PUT(C0390,YYMMDD10.) AS C0390

FROM 
	SDW_S060204_PART_B 

LEFT JOIN 
	X_EIOPA_CD INFRA
		ON 
			C0300 = INFRA.EIOPA_CD
			AND INFRA.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND INFRA.EIOPA_CATEGORY = 'INFRASTRUCTURE_INVESTMENT'

LEFT JOIN 
	X_EIOPA_CD PART
		ON 
			TRIM(C0310) = TRIM(PART.EIOPA_CD)
			AND PART.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(PART.EIOPA_CATEGORY) = 'PARTICIPATION_CD'

LEFT JOIN 
	X_EIOPA_CD ECAI
		ON 
			C0330 = ECAI.EIOPA_DESCRIPTION
			AND ECAI.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(ECAI.EIOPA_CATEGORY) = 'ECAI'

LEFT JOIN 
	X_EIOPA_CD QUAL
		ON 
			C0340 = QUAL.EIOPA_CD 
			AND QUAL.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(QUAL.EIOPA_CATEGORY) = 'CREDIT_QUALITY_STEP'

		;
QUIT;




