PROC SQL ;

OPTIONS MISSING='';

CREATE TABLE SDW_S080104_PARTA_VW AS 

SELECT 
	C0020	INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0040 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0070 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0090 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0010 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, PORT.XBRL_CD AS C0060_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0060 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, LINK.XBRL_CD AS C0080_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0080 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, DVTS.XBRL_CD AS C0110_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0110  INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, '' AS C0120 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0130 AS C0130 FORMAT = 12.2 INFORMAT=COMMA12. LABEL = ''

	, SUBSTR(TRIM(BYSE.XBRL_CD),1,INDEX(TRIM(BYSE.XBRL_CD),'/')-1) AS C0140_XBRL 
			INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0140 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	
	, C0150 FORMAT = 12.2 LABEL = ''
	, C0160 FORMAT = 12.2 LABEL = ''
	, C0170 FORMAT 12. LABEL = ''
	
	, '' AS C0180 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, '' AS C0190 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0200 FORMAT = 12.2 LABEL = ''
	, C0210 FORMAT = 12.2 LABEL = ''
	, PUT(C0220,YYMMDD10.) AS C0220  FORMAT=$CHAR10.
	, C0230  LABEL = ''
	, C0240 LABEL = ''

	, SUBSTR(TRIM(VALU.XBRL_CD),INDEX(TRIM(VALU.XBRL_CD),'/')+1,LENGTH(TRIM(VALU.XBRL_CD))) AS C0250_XBRL 
	 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0250  INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	

FROM 
	SDW_S080104_PART_A 

LEFT JOIN 
	X_EIOPA_CD PORT
		ON 
			C0060 = PORT.EIOPA_CD
			AND PORT.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND PORT.EIOPA_CATEGORY = 'PORTFOLIO_CLASSIFICATION'

LEFT JOIN 
	X_EIOPA_CD LINK
		ON 
			TRIM(C0080) = TRIM(LINK.EIOPA_CD)
			AND LINK.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(LINK.EIOPA_CATEGORY) = 'UNIT_INDEX_LINKED'

LEFT JOIN 
	X_EIOPA_CD DVTS
		ON 
			C0110 = DVTS.EIOPA_CD
			AND DVTS.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(DVTS.EIOPA_CATEGORY) = 'USE_OF_DRVTS'

LEFT JOIN
	X_EIOPA_CD BYSE /*Buyer Seller*/
		ON 
			C0140 = BYSE.EIOPA_CD 
			AND BYSE.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(BYSE.EIOPA_CATEGORY) = 'LONG_OR_SHORT_POSITION'
	
LEFT JOIN 
	X_EIOPA_CD VALU
		ON 
			C0250 = VALU.EIOPA_CD  
			AND VALU.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(VALU.EIOPA_CATEGORY) = 'VALUATION_METHOD'



;


QUIT;



PROC SQL ;

OPTIONS MISSING='';

CREATE TABLE SDW_S080104_PARTB_VW AS 

SELECT 

	C0040 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0260 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0270 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0290 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, CASE 
		WHEN C0300 = 'S&P Global Ratings Europe Limited (LEI code:5493008B2TU3S6QE1E12)'  THEN 's2c_SE:x179'
		WHEN C0300 = 'Fitch Ratings Limited (LEI code: 2138009F8YAHVC8W3Q52)' THEN 's2c_SE:x147'
		WHEN C0300 = 'Moody¡¦s Investors Service Ltd (LEI code: 549300SM89WABHDNJ349)'  THEN 's2c_SE:x154'
		ELSE ECAI.XBRL_CD 
	  END AS C0300_XBRL INFORMAT=$200. FORMAT=$200. LENGTH=200 LABEL = ''
	, C0300  INFORMAT=$200. FORMAT=$200. LENGTH=200 LABEL = ''

	, QUAL.XBRL_CD AS C0310_XBRL  INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0310 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, '' AS C0320 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0330 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0340 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0360 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, CASE 
		WHEN C0370 = '' THEN ''
		ELSE 's2c_CU:'||C0370
	  END AS C0370_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0370 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, C0380 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0390 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, UNWI.XBRL_CD AS C0400_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, C0400 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, '' AS C0410_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, '' AS C0410 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, '' AS C0420_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
	, '' AS C0420 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

	, PUT(C0430,YYMMDD10.) AS C0430  FORMAT=$10. 


FROM 
	SDW_S080104_PART_B 


LEFT JOIN 
	X_EIOPA_CD UNWI
		ON 
			TRIM(C0400) = TRIM(UNWI.EIOPA_CD)
			AND UNWI.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(UNWI.EIOPA_CATEGORY) = 'UNWIND_TRIGGER'

LEFT JOIN 
	X_EIOPA_CD ECAI
		ON 
			C0300 = ECAI.EIOPA_DESCRIPTION
			AND ECAI.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(ECAI.EIOPA_CATEGORY) = 'ECAI'
			AND ECAI.EIOPA_SHORT_DESC LIKE '%HIG%' 

LEFT JOIN 
	X_EIOPA_CD QUAL
		ON 
			C0310 = QUAL.EIOPA_CD 
			AND QUAL.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND TRIM(QUAL.EIOPA_CATEGORY) = 'CREDIT_QUALITY_STEP'

	;

QUIT;

