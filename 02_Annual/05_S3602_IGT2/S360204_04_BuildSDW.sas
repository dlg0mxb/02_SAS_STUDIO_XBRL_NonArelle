PROC SQL ;

OPTIONS MISSING='';

CREATE TABLE SDW_S360204_PARTA_VW AS 

SELECT 	
		C0010 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		, C0030 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		, C0080 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		, C0060 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		, C0050 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		, C0140 FORMAT=12.2 INFORMAT=12.2 LABEL=''
		, C0120 FORMAT=YYMMDD10. INFORMAT=YYMMDD10. LABEL = ''

		, ASST.XBRL_CD AS C0100_XBRL  INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		, C0100 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

		, C0150 FORMAT=12.2 INFORMAT=12.2 LABEL=''
		, C0020 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		, C0110 FORMAT=YYMMDD10. INFORMAT=YYMMDD10. LABEL = ''

		, CASE 
			WHEN C0130 = '' THEN ''
			ELSE 's2c_CU:'||C0130
		  END AS C0130_XBRL INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		, C0130 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

		, DRVTS.XBRL_CD AS C0170_XBRL  INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		, C0170 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''

		, C0180 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		
		,  C0160 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		,  C0200 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		,  C0210 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		,  C0220 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		,  C0230 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
		,  C0240 INFORMAT=$100. FORMAT=$100. LENGTH=100 LABEL = ''
FROM 
	SDW_S360204_PART_A 

LEFT JOIN 
	X_EIOPA_CD ASST
		ON 
			C0100 = TRIM(ASST.EIOPA_CD)
			AND ASST.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND ASST.EIOPA_CATEGORY = 'IGT_TRANS_TYPE_DRVTS'

LEFT JOIN 
	X_EIOPA_CD DRVTS
		ON 		
			TRIM(C0170) = TRIM(DRVTS.EIOPA_CD)
			AND DRVTS.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND DRVTS.EIOPA_CATEGORY = 'USE_OF_DRVTS'
	;

QUIT;


/*
More columns will be expected during Q4-2021 run

	s2md_met_mi1166	AS C0160
	s2md_met_si1331	AS C0200
	s2md_met_si1333	AS C0210
	s2md_met_si1334	AS C0220
	s2md_met_ei1904	AS C0230
	s2md_met_ei1905	AS C0240
*/


