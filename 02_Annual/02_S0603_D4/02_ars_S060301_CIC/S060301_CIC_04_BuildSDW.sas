PROC SQL ;

OPTIONS MISSING='';

CREATE TABLE SDW_S060301_PARTA_VW AS 

SELECT 

	C0010 INFORMAT=$17. FORMAT=$17. LENGTH=17 LABEL = 'C0010'

	, ASST.XBRL_CD AS C0030_XBRL INFORMAT=$88. FORMAT=$88. LENGTH=88 LABEL = 'C0030_XBRL'
	, C0030 INFORMAT=$14. FORMAT=$14. LENGTH=14 LABEL = 'C0030'

	, CASE 
		WHEN C0040 = 'GBXT' THEN 's2c_GA:x115' 
		ELSE CASE 
				WHEN C0040 = '' THEN ''
				ELSE TRIM('s2c_GA:'||TRIM(C0040)) 
			 END 
	  END AS C0040_XBRL  INFORMAT=$88. FORMAT=$88. LENGTH=88 LABEL = 'C0040_XBRL'
	, C0040 INFORMAT=$9. FORMAT=$9. LENGTH=9 LABEL = 'C0040'

	, CURR.XBRL_CD AS C0050_XBRL   INFORMAT=$88. FORMAT=$88. LENGTH=88 LABEL = 'C0050_XBRL'
	, C0050  INFORMAT=$14. FORMAT=$14. LENGTH=14 LABEL = 'C0050'

	, C0060 FORMAT=12.2  LABEL = 'C0060'

FROM 
	SDW_S060301_PART_A 

LEFT JOIN 
	X_EIOPA_CD ASST
		ON 
			TRIM(C0030) = TRIM(ASST.EIOPA_CD)
			AND ASST.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND ASST.EIOPA_CATEGORY = 'ASSET_CATEGORY'

LEFT JOIN 
	X_EIOPA_CD CURR
		ON 
			C0050 = CURR.EIOPA_CD
			AND CURR.EFFECTIVE_TO_DATE = '31/12/9999  23:59:59'
			AND CURR.EIOPA_CATEGORY = 'CURRENCY_TYPE'
		;
QUIT;
